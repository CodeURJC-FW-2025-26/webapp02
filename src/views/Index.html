<!DOCTYPE html>

{{> partials/header}}

<main>
     <!-- Banner with search bar and add button -->
     <section class="banner">
          <!-- Search Form -->
          <div class="search-container">
               <form action="/" method="GET" role="search">
                    <input type="text" name="search" placeholder="Buscar una receta por nombre..."
                         value="{{searchQuery}}">
               </form>
          </div>
          <!-- Recipe section title and action button -->
          <div class="banner-content">
               <h2 class="banner-title">RECETAS RECOMENDADAS</h2>
               <a class="btn btn-dark" href="/receta/nueva">Añadir receta</a>
          </div>
     </section>

     <!-- Category Filter Buttons -->
     <section class="category-buttons">
          <a href="/">Todas</a>
          <a href="/?category=entrante">Entrantes</a>
          <a href="/?category=principal">Platos Principales</a>
          <a href="/?category=postre">Postres</a>
          <a href="/?category=vegano">Veganos</a>
     </section>

     <!-- Recommended recipes grid -->
     <section class="container">
          <div class="row">
               {{#recipes}}
               <!-- Loop: This will repeat for each recipe in the 'recipes' array -->
               <div class="col-12 col-sm-6 col-lg-4">
                    <a href='/receta/{{_id}}'><img src="/uploads/{{image}}" alt="{{name}}"></a>
                    <h3>{{name}}</h3>
               </div>
               {{/recipes}}

               {{^recipes}}
               <!-- This is shown if the 'recipes' array is empty -->
               <div class="col-12 text-center my-5">
                    <h3>No se encontraron recetas que coincidan con tu búsqueda.</h3>
               </div>
               {{/recipes}}
          </div>
     </section>

     <!-- Pagination -->
     <!-- Solo mostramos la paginación si hay recetas -->
     {{#recipes.length}} {{! Solo mostramos la paginación si el array de recetas no está vacío }}
     <nav aria-label="Paginación de recetas" class="d-flex justify-content-center mb-5">
          <ul class="pagination">

               <!-- Botón "Anterior" -->
               {{#hasPrevPage}}
               <li class="page-item">
                    <a class="page-link" href="/?page={{prevPage}}&search={{searchQuery}}&category={{categoryQuery}}"
                         aria-label="Anterior">
                         <span aria-hidden="true">&laquo;</span>
                    </a>
               </li>
               {{/hasPrevPage}}
               {{^hasPrevPage}}
               <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true" aria-label="Anterior">
                         <span aria-hidden="true">&laquo;</span>
                    </a>
               </li>
               {{/hasPrevPage}}

               <!-- Botones de Páginas Numéricas (generados dinámicamente) -->
               {{#pagesForTemplate}}
               {{^isEllipsis}}
               <li class="page-item {{#isCurrent}}active{{/isCurrent}}">
                    <a class="page-link"
                         href="/?page={{page}}&search={{searchQuery}}&category={{categoryQuery}}">{{page}}</a>
               </li>
               {{/isEllipsis}}
               {{#isEllipsis}}
               <li class="page-item disabled"><span class="page-link">...</span></li>
               {{/isEllipsis}}
               {{/pagesForTemplate}}


               <!-- Botón "Siguiente" -->
               {{#hasNextPage}}
               <li class="page-item">
                    <a class="page-link" href="/?page={{nextPage}}&search={{searchQuery}}&category={{categoryQuery}}"
                         aria-label="Siguiente">
                         <span aria-hidden="true">&raquo;</span>
                    </a>
               </li>
               {{/hasNextPage}}
               {{^hasNextPage}}
               <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true" aria-label="Siguiente">
                         <span aria-hidden="true">&raquo;</span>
                    </a>
               </li>
               {{/hasNextPage}}
          </ul>
     </nav>
     {{/recipes.length}}
</main>

{{> partials/footer}}

</html>